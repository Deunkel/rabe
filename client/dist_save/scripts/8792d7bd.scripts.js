"use strict";function Label(e){this.setValues(e);var l=this.spanElem=document.createElement("span");l.style.cssText="position: relative;left: -50%;top: -10px;font-weight: bold;white-space: nowrap;padding: 0px;z-index: 100000;";var o=this.divElem=document.createElement("div");o.appendChild(l),o.style.cssText="position: absolute; display: none"}angular.module("clientApp",["ui"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("clientApp").controller("MainCtrl",["$scope","$http",function(e,l){function o(){var l={zoom:17,center:new google.maps.LatLng(49.76785,6.628745),disableDefaultUI:!0,scrollwheel:!1,draggable:!1,disableDoubleClickZoom:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};e.map=new google.maps.Map(document.getElementById("map_canvas"),l),e.paintBuildings=function(){angular.forEach(e.buildings,function(l){l.polygon&&l.polygon.setMap(null),l.polygon=l.selected?new google.maps.Polygon({paths:l.path,strokeColor:e.selectionStrokeColor,strokeOpacity:l.strokeOpacity,strokeWeight:e.selectionStrokeWeight,fillColor:e.selectionFillColor,fillOpacity:e.selectionfillOpacity}):new google.maps.Polygon({paths:l.path,strokeColor:l.strokeColor,strokeOpacity:l.strokeOpacity,strokeWeight:l.strokeWeight,fillColor:l.fillColor,fillOpacity:l.fillOpacity}),l.polygon.setMap(e.map),l.label||(l.label=new Label({position:l.labelPos,map:e.map,text:l.name})),google.maps.event.addListener(l.polygon,"click",function(){e.$apply(function(){l.selected=!l.selected,e.paintBuildings()})})})},e.paintBuildings()}function t(l){var t=new google.maps.LatLng(l.coords.latitude,l.coords.longitude);o(),void 0!==g&&g.setMap(null),g=new google.maps.Marker({position:t,map:e.map,title:"User location"})}function n(e){o();var l={1:"Permission denied",2:"Position unavailable",3:"Request timeout"};console.log("Error: "+l[e.code])}e.showSearch=!0,e.showTime=!0,e.showMap=!0,e.query="",l.get("json/rooms.json").success(function(l){e.rooms=l}),e.chooseObject=function(l){e.choice=l},e.buildingFillColor="#ddd",e.buildingFillOpacity=1,e.buildingStrokeColor="#333",e.buildingStrokeOpacity=.8,e.buildingStrokeWeight=2,e.selectionFillColor="#f77f00",e.selectionfillOpacity=1,e.selectionStrokeColor=e.buildingStrokeColor,e.selectionStrokeOpacity=e.buildingStrokeOpacity,e.selectionStrokeWeight=e.buildingStrokeWeight,e.buildings={A:{name:"A",path:[new google.maps.LatLng(49.768642,6.62721),new google.maps.LatLng(49.768572,6.627602),new google.maps.LatLng(49.76825,6.627462),new google.maps.LatLng(49.768326,6.62706),new google.maps.LatLng(49.768642,6.62721)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.768452,6.627343),selected:!0},B:{name:"B",path:[new google.maps.LatLng(49.768496,6.627983),new google.maps.LatLng(49.768427,6.62838),new google.maps.LatLng(49.768108,6.628235),new google.maps.LatLng(49.768184,6.627832),new google.maps.LatLng(49.768496,6.627983)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.768307,6.628118),selected:!0},C:{name:"C",path:[new google.maps.LatLng(49.768356,6.628758),new google.maps.LatLng(49.768281,6.62916),new google.maps.LatLng(49.767962,6.629015),new google.maps.LatLng(49.768037,6.628616),new google.maps.LatLng(49.768356,6.628758)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.768166,6.62889),selected:!0},D:{name:"D",path:[new google.maps.LatLng(49.768212,6.629528),new google.maps.LatLng(49.768137,6.629922),new google.maps.LatLng(49.76782,6.629785),new google.maps.LatLng(49.767898,6.629388),new google.maps.LatLng(49.768212,6.629528)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.768021,6.629652),selected:!0},E:{name:"E",path:[new google.maps.LatLng(49.768078,6.630901),new google.maps.LatLng(49.767961,6.63103),new google.maps.LatLng(49.767999,6.631142),new google.maps.LatLng(49.767663,6.631512),new google.maps.LatLng(49.767396,6.630944),new google.maps.LatLng(49.767753,6.630563),new google.maps.LatLng(49.767784,6.630627),new google.maps.LatLng(49.767905,6.630504),new google.maps.LatLng(49.768078,6.630901)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767754,6.630972),selected:!0},F:{name:"F",path:[new google.maps.LatLng(49.767649,6.6303),new google.maps.LatLng(49.76776,6.630557),new google.maps.LatLng(49.767377,6.630973),new google.maps.LatLng(49.767262,6.630713),new google.maps.LatLng(49.767656,6.630305),new google.maps.LatLng(49.767649,6.6303)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.76752,6.630634),selected:!0},G:{name:"G",path:[new google.maps.LatLng(49.767353,6.630217),new google.maps.LatLng(49.767474,6.63049),new google.maps.LatLng(49.767264,6.63071),new google.maps.LatLng(49.767302,6.630796),new google.maps.LatLng(49.767214,6.630893),new google.maps.LatLng(49.767025,6.630474),new google.maps.LatLng(49.767087,6.630415),new google.maps.LatLng(49.767112,6.630466),new google.maps.LatLng(49.767351,6.63022),new google.maps.LatLng(49.767353,6.630217)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767331,6.630443),selected:!0},H:{name:"H",path:[new google.maps.LatLng(49.767332,6.629989),new google.maps.LatLng(49.767406,6.630152),new google.maps.LatLng(49.767112,6.630469),new google.maps.LatLng(49.767036,6.630305),new google.maps.LatLng(49.767332,6.629989)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767208,6.630242),selected:!0},J:{name:"J",path:[new google.maps.LatLng(49.767176,6.629501),new google.maps.LatLng(49.767212,6.629688),new google.maps.LatLng(49.766904,6.629839),new google.maps.LatLng(49.766866,6.62964),new google.maps.LatLng(49.767176,6.629501)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.76704,6.629668),selected:!0},K:{name:"K",path:[new google.maps.LatLng(49.767169,6.628951),new google.maps.LatLng(49.767157,6.629149),new google.maps.LatLng(49.766833,6.629133),new google.maps.LatLng(49.766841,6.628932),new google.maps.LatLng(49.767169,6.628951)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767009,6.629043),selected:!0},L:{name:"L",path:[new google.maps.LatLng(49.767262,6.628363),new google.maps.LatLng(49.767221,6.628551),new google.maps.LatLng(49.766902,6.628436),new google.maps.LatLng(49.766947,6.628221),new google.maps.LatLng(49.767262,6.628363)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767089,6.628408),selected:!0},N:{name:"N",path:[new google.maps.LatLng(49.767297,6.628066),new google.maps.LatLng(49.767265,6.628227),new google.maps.LatLng(49.767085,6.628152),new google.maps.LatLng(49.767116,6.627985),new google.maps.LatLng(49.767297,6.628066)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767191,6.628099),selected:!0},O:{name:"O",path:[new google.maps.LatLng(49.767375,6.627755),new google.maps.LatLng(49.767335,6.62794),new google.maps.LatLng(49.767025,6.627824),new google.maps.LatLng(49.767065,6.627631),new google.maps.LatLng(49.767375,6.627755)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767191,6.627791),selected:!0},T:{name:"T",path:[new google.maps.LatLng(49.767678,6.626585),new google.maps.LatLng(49.768111,6.626768),new google.maps.LatLng(49.768065,6.627038),new google.maps.LatLng(49.767626,6.626853),new google.maps.LatLng(49.767678,6.626585)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767872,6.626814),selected:!0},M:{name:"M",path:[new google.maps.LatLng(49.768595,6.627079),new google.maps.LatLng(49.768409,6.626655),new google.maps.LatLng(49.768804,6.626258),new google.maps.LatLng(49.768972,6.6267),new google.maps.LatLng(49.768595,6.627079)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.768705,6.626672),selected:!0},X:{name:"X",path:[new google.maps.LatLng(49.767354,6.628296),new google.maps.LatLng(49.767305,6.628565),new google.maps.LatLng(49.767737,6.628739),new google.maps.LatLng(49.767788,6.628476),new google.maps.LatLng(49.767354,6.628296)],strokeColor:e.buildingStrokeColor,strokeOpacity:e.buildingStrokeOpacity,strokeWeight:e.buildingStrokeWeight,fillColor:e.buildingFillColor,fillOpacity:e.buildingFillOpacity,polygon:null,label:null,labelPos:new google.maps.LatLng(49.767556,6.628534),selected:!0}};var g;if(navigator.geolocation){var i=1e7;navigator.geolocation.watchPosition(t,n,{enableHighAccuracy:!0,timeout:i,maximumAge:0})}else alert("Geolocation is not supported by this browser")}]),angular.module("clientApp").filter("freeRoom",function(){return function(e,l,o){if(!e)return[];if(!l||!o)return e;var t=[],n=function(e,l){var o=e.substr(0,2),t=e.substr(3,2),n=l;return n.setHours(o),n.setMinutes(t),n.setSeconds(0),n.setMilliseconds(0),n};return l=n(l,new Date),o=n(o,new Date),l>o&&o.setDate(o.getDate()+1),angular.forEach(e,function(e){var n=!0;angular.forEach(e.events[0],function(e){n=(e.end.getTime()<=l.getTime()||e.start.getTime()>=o.getTime())&&n?!0:!1}),n&&t.push(e)}),t}}),angular.module("clientApp").filter("selectedBuilding",function(){return function(e,l){if(!e)return[];var o=[],t=[];return angular.forEach(l,function(e){e.selected&&t.push(e.name)}),angular.forEach(e,function(e){-1!==t.indexOf(e.name.substr(0,1))&&o.push(e)}),o}}),angular.module("clientApp").controller("NavbarCtrl",["$scope",function(){}]),Label.prototype=new google.maps.OverlayView,Label.prototype.onAdd=function(){var e=this.getPanes().overlayLayer;e.appendChild(this.divElem);var l=this;this.listeners=[google.maps.event.addListener(this,"position_changed",function(){l.draw()}),google.maps.event.addListener(this,"text_changed",function(){l.draw()})]},Label.prototype.onRemove=function(){this.divElem.parentNode.removeChild(this.divElem);for(var e=0,l=this.listeners.length;l>e;++e)google.maps.event.removeListener(this.listeners[e])},Label.prototype.draw=function(){var e=this.getProjection(),l=e.fromLatLngToDivPixel(this.get("position")),o=this.divElem;o.style.left=l.x+"px",o.style.top=l.y+"px",o.style.display="block",this.spanElem.innerHTML=""+this.get("text")};